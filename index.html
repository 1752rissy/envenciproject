<!DOCTYPE html>
<html>
<head>
    <title>Vende lo que necesitas vender con inteligencia</title>
</head>
<body>
    <h1>ðŸ“¸ Toma una foto de tu producto</h1>
    <video id="camera" autoplay></video>
    <button id="capture">Capturar</button>
    <img id="preview" hidden>
    <textarea id="descripcion" placeholder="DescripciÃ³n..."></textarea>
    <input type="number" id="precio" placeholder="Precio (USD)">
    <button id="publish">Publicar</button>

    <script>
        const video = document.getElementById('camera');
        const captureBtn = document.getElementById('capture');
        const preview = document.getElementById('preview');
        const descripcion = document.getElementById('descripcion');
        const publishBtn = document.getElementById('publish');

        // Acceder a la cÃ¡mara
        navigator.mediaDevices.getUserMedia({ video: true })
            .then(stream => video.srcObject = stream);

        // Capturar foto
        captureBtn.addEventListener('click', () => {
            const canvas = document.createElement('canvas');
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            canvas.getContext('2d').drawImage(video, 0, 0);
            preview.src = canvas.toDataURL('image/jpeg');
            preview.hidden = false;

            // Enviar a Gemini para descripciÃ³n (simplificado)
            fetch('/upload', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ image: preview.src })
            })
            .then(res => res.json())
            .then(data => descripcion.value = data.descripcion);
        });

        // Publicar producto
        publishBtn.addEventListener('click', () => {
            fetch('/upload', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    image: preview.src,
                    precio: document.getElementById('precio').value
                })
            })
            .then(() => alert('Â¡Producto publicado!'));
        });
    </script>
</body>
</html>